function Calendar(b,f,e,d,a,c){this.beginYear=b||1870;this.endYear=f||2050;this.setbeginYear=b||1870;this.setendYear=f||2050;this.language=e||0;if(window.langVer){this.language=window.langVer}this.patternDelimiter=d||"-";this.date2StringPattern=a||Calendar.language.date2StringPattern[this.language].replace(/\-/g,this.patternDelimiter);this.string2DatePattern=c||Calendar.language.string2DatePattern[this.language];this.dateControl=null;this.panel=this.getElementById("__calendarPanel");this.iframe=window.frames.__calendarIframe;this.form=null;this.date=new Date();this.year=this.date.getFullYear();this.month=this.date.getMonth();this.dateLimit=null;this.colors={bg_cur_day:"#00CC33",bg_over:"#fff",bg_out:"#FFCC00"}}Calendar.language={year:["\u5e74","","","\u5e74"],months:[["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"]],weeks:[["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"]],clear:["\u6e05\u7a7a","Clear","Clear","\u6e05\u7a7a"],today:["\u4eca\u5929","Today","Today","\u4eca\u5929"],close:["\u5173\u95ed","Close","Close","\u95dc\u9589"],date2StringPattern:["yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd"],string2DatePattern:["ymd","ymd","ymd","ymd"]};Calendar.prototype.draw=function(){calendar=this;var c=[];c[c.length]='<form id="__calendarForm" name="__calendarForm" method="post">';c[c.length]='<table id="__calendarTable" width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';c[c.length]=" <tr>";c[c.length]='  <th><input class="l" name="goPrevMonthButton" type="button" id="goPrevMonthButton" value="&lt;" /></th>';c[c.length]='  <th colspan="5"><select class="year" name="yearSelect" id="yearSelect"></select><select class="month" name="monthSelect" id="monthSelect"></select></th>';c[c.length]='  <th><input class="r" name="goNextMonthButton" type="button" id="goNextMonthButton" value="&gt;" /></th>';c[c.length]=" </tr>";c[c.length]=" <tr>";for(var b=0;b<7;b++){c[c.length]='<th class="theader">';c[c.length]=Calendar.language.weeks[this.language][b];c[c.length]="</th>"}c[c.length]="</tr>";for(var b=0;b<6;b++){c[c.length]='<tr align="center">';for(var a=0;a<7;a++){switch(a){case 0:c[c.length]='<td class="sun">&nbsp;</td>';break;case 6:c[c.length]='<td class="sat">&nbsp;</td>';break;default:c[c.length]='<td class="normal">&nbsp;</td>';break}}c[c.length]="</tr>"}c[c.length]=" <tr>";c[c.length]='  <th colspan="2"><input type="button" class="b" name="clearButton" id="clearButton" /></th>';c[c.length]='  <th colspan="3"><input type="button" class="b" name="selectTodayButton" id="selectTodayButton" /></th>';c[c.length]='  <th colspan="2"><input type="button" class="b" name="closeButton" id="closeButton" /></th>';c[c.length]=" </tr>";c[c.length]="</table>";c[c.length]="</form>";this.iframe.document.body.innerHTML=c.join("");this.form=this.iframe.document.forms.__calendarForm;this.form.clearButton.value=Calendar.language.clear[this.language];this.form.selectTodayButton.value=Calendar.language.today[this.language];this.form.closeButton.value=Calendar.language.close[this.language];this.form.goPrevMonthButton.onclick=function(){calendar.goPrevMonth(this)};this.form.goNextMonthButton.onclick=function(){calendar.goNextMonth(this)};this.form.yearSelect.onchange=function(){calendar.update(this)};this.form.monthSelect.onchange=function(){calendar.update(this)};this.form.clearButton.onclick=function(){calendar.dateControl.value="";if(calendar.dateControl.onchange){calendar.dateControl.onchange()}calendar.hide()};this.form.closeButton.onclick=function(){calendar.hide()};this.form.selectTodayButton.onclick=function(){if(calendar.unuselimit||calendar.todayUnuse){return}var d=new Date();calendar.date=d;calendar.year=d.getFullYear();calendar.month=d.getMonth();calendar.dateControl.value=d.format(calendar.date2StringPattern);if(calendar.dateControl.onchange){calendar.dateControl.onchange()}calendar.hide()}};Calendar.prototype.bindYear=function(){var c=this.form.yearSelect;c.length=0;if(this.dateLimit){var g=this.beginYear;var a=this.endYear;var f=this.dateLimit.split("|");if(f[0]){var e=f[0].split("-");g=e[0]||this.beginYear}if(f[1]){var d=f[1].split("-");a=d[0]||this.endYear}this.beginYear=g;this.endYear=a}else{this.beginYear=this.setbeginYear;this.endYear=this.setendYear}for(var b=this.beginYear;b<=this.endYear;b++){c.options[c.length]=new Option(b+Calendar.language.year[this.language],b)}};Calendar.prototype.bindMonth=function(d){var b=this.form.monthSelect;b.length=0;var h=0;var a=12;if(this.dateLimit){var g=this.dateLimit.split("|");var f=[""];var e=[""];if(g[0]){f=g[0].split("-");if(f[0]==calendar.date.getFullYear()){h=f[1]-1}}if(g[1]){e=g[1].split("-");if(e[0]==calendar.date.getFullYear()){a=e[1]-0}}if((!g[0]&&e[0]>calendar.date.getFullYear())||(h>a&&f[0]<calendar.date.getFullYear())||(!g[1]&&f[0]<calendar.date.getFullYear())){h=0}else{h>a?a=12:""}}for(var c=h;c<a;c++){b.options[b.length]=new Option(Calendar.language.months[this.language][c],c)}if(this.dateLimit&&d&&(this.month<h||this.month>a)){this.month=h+"";this.date=new Date(this.year,this.month,1)}};Calendar.prototype.goPrevMonth=function(c){if(this.year==this.beginYear&&this.month==0){return}if(this.dateLimit){var b=this.dateLimit.split("|");if(b[0]){var a=b[0].split("-");if(a[0]==this.year&&a[1]-1>=this.month){return}}}this.month--;if(this.month==-1){this.year--;this.month=11}this.date=new Date(this.year,this.month,1);if(this.dateLimit){this.bindMonth()}this.changeSelect();this.bindData()};Calendar.prototype.goNextMonth=function(c){if(this.year==this.endYear&&this.month==11){return}if(this.dateLimit){var b=this.dateLimit.split("|");if(b[1]){var a=b[1].split("-");if(a[0]==this.year&&a[1]-1<=this.month){return}}}this.month++;if(this.month==12){this.year++;this.month=0}this.date=new Date(this.year,this.month,1);if(this.dateLimit){this.bindMonth()}this.changeSelect();this.bindData()};Calendar.prototype.changeSelect=function(){var c=this.form.yearSelect;var a=this.form.monthSelect;for(var b=0;b<c.length;b++){if(c.options[b].value==this.date.getFullYear()){c[b].selected=true;break}}for(var b=0;b<a.length;b++){if(a.options[b].value==this.date.getMonth()){a[b].selected=true;break}}};Calendar.prototype.update=function(a){this.year=a.form.yearSelect.options[a.form.yearSelect.selectedIndex].value;this.month=a.form.monthSelect.options[a.form.monthSelect.selectedIndex].value;this.date=new Date(this.year,this.month,1);if(this.dateLimit){this.bindMonth(1)}this.changeSelect();this.bindData()};Calendar.prototype.bindData=function(){var h=this;var a=this.getMonthViewDateArray(this.date.getFullYear(),this.date.getMonth());var j=this.getElementsByTagName("td",this.getElementById("__calendarTable",this.iframe.document));if(this.dateLimit){var d=this.dateLimit.split("|");var n=true;var k=[];var b=[];var c=1;var e=31;var g=h.date.getFullYear();var m=h.date.getMonth();if(d[0]){k=d[0].split("-");c=k[2]||1}if(d[1]){b=d[1].split("-");e=b[2]||31}if(d[0]&&d[1]){if(b[0]>k[0]&&g>k[0]&&g<b[0]){n=false}if(g>k[0]){if(!g==b[0]&&m==b[1]-1){e=31}if(m<b[1]-1){n=false}c=1}if(g<b[0]){e=31;if(m>k[1]-1){n=false}}if(b[1]>k[1]&&m<b[1]-1){e=31}if(b[1]>k[1]&&m>k[1]-1){c=1}}if((!d[1]&&(g!=k[0]||m!=k[1]-1))||(!d[0]&&(g!=b[0]||m!=b[1]-1))){n=false}}for(var f=0;f<j.length;f++){j[f].style.backgroundColor=h.colors.bg_over;j[f].onclick=null;j[f].onmouseover=null;j[f].onmouseout=null;j[f].innerHTML=a[f]||"&nbsp;";if(this.unuselimit||this.dateLimit&&n&&(a[f]<c||a[f]>e)){j[f].canUse=false;j[f].style.cursor="not-allowed";j[f].style.color="#8c8c8c"}else{j[f].canUse=true;j[f].style.cursor="pointer";j[f].style.color="#333"}if(f>a.length-1){continue}if(a[f]){if(h.dateLimit&&!j[f].canUse||this.unuselimit){continue}j[f].onclick=function(){if(h.dateControl){h.dateControl.value=new Date(h.date.getFullYear(),h.date.getMonth(),this.innerHTML).format(h.date2StringPattern);if(h.dateControl.onchange){h.dateControl.onchange()}}h.hide()};j[f].onmouseover=function(){this.style.backgroundColor="#EDF7FF";this.style.color="#1ea0fa";this.style.border="1px solid #1ea0fa"};j[f].onmouseout=function(){this.style.backgroundColor="#fff";this.style.color="#333";this.style.border="1px solid #fff"};var l=new Date();if(l.getFullYear()==h.date.getFullYear()){if(l.getMonth()==h.date.getMonth()){if(l.getDate()==a[f]){j[f].style.color="#1ea0fa";j[f].onmouseover=function(){this.style.backgroundColor="#EDF7FF";this.style.color="#1ea0fa";this.style.border="1px solid #1ea0fa"};j[f].onmouseout=function(){this.style.backgroundColor="#fff";this.style.color="#1ea0fa";this.style.border="1px solid #fff"}}}}}}};Calendar.prototype.getMonthViewDateArray=function(f,a){var d=new Array(42);var b=new Date(f,a,1).getDay();var e=new Date(f,a+1,0).getDate();for(var c=0;c<e;c++){d[c+b]=c+1}return d};Calendar.prototype.show=function(h,l,g,j){if(this.panel.style.visibility=="visible"){this.panel.style.visibility="hidden"}if(!h){throw new Error("arguments[0] is necessary!")}this.dateControl=h;this.dateLimit=j;if(this.dateLimit){var c=this.dateLimit.split("|");var f=[];var a=[];var d=new Date();if(c[0]){f=c[0].split("-");if(new Date(f[0],f[1]-1,f[2])>d){this.todayUnuse=true}}if(c[1]){a=c[1].split("-");if(new Date(a[0],a[1]-1,a[2])<d){this.todayUnuse=true}}if(c[0]&&c[1]){var i=d.getMonth()+1<10?"0"+(d.getMonth()+1):d.getMonth()+1;i=d.getFullYear()+"-"+i+"-"+d.getDate();if(c[0]==c[1]&&c[0]==i){this.todayUnuse=false}}if(c[0]&&c[1]&&new Date(f[0],f[1]-1,f[2])>new Date(a[0],a[1]-1,a[2])){this.unuselimit=true}if(c[0]&&new Date(f[0],f[1]-1,f[2])>new Date()){this.date=new Date(f[0],f[1]-1,f[2])}else{if(c[1]&&new Date(a[0],a[1]-1,a[2])<new Date()){this.date=new Date(a[0],a[1]-1,a[2])}else{this.date=new Date()}}}else{this.date=new Date()}this.year=this.date.getFullYear();this.month=this.date.getMonth();l=l||h;var k=g||window.event;if(k){if(k.stopPropagation){k.stopPropagation()}k.cancelBubble=true}this.draw();this.bindYear();this.bindMonth();if(h.value.length>0){var b=h.value.toDate(this.patternDelimiter,this.string2DatePattern);if(b){this.date=b;this.year=this.date.getFullYear();this.month=this.date.getMonth()}}else{if(h.getAttribute("year")){this.year=h.getAttribute("year")||"";this.date=new Date(this.year,this.date.getMonth(),this.date.getDate())}}this.changeSelect();this.bindData();var m=this.getAbsPoint(l);this.panel.style.left=m.x+"px";this.panel.style.top=(m.y+h.offsetHeight)+"px";this.panel.style.visibility="visible"};Calendar.prototype.hide=function(){this.panel.style.visibility="hidden"};Calendar.prototype.getElementById=function(b,a){a=a||document;return document.getElementById?a.getElementById(b):document.all(b)};Calendar.prototype.getElementsByTagName=function(b,a){a=a||document;return document.getElementsByTagName?a.getElementsByTagName(b):document.all.tags(b)};Calendar.prototype.getAbsPoint=function(d){var c=/^q(\d+)_?/;var h=0;if(d&&d.id&&c.exec(d.id)){var b=c.exec(d.id)[1];if(b){var g=document.getElementById("divquestion"+b);if(g){h=g.scrollLeft}}}var a=d.offsetLeft;var f=d.offsetTop;while(d=d.offsetParent){a+=d.offsetLeft;f+=d.offsetTop}a-=h;return{x:a,y:f}};Date.prototype.format=function(b){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var a in c){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,RegExp.$1.length==1?c[a]:("00"+c[a]).substr((""+c[a]).length))}}return b};String.prototype.toDate=function(e,f){e=e||"-";f=f||"ymd";var c=this.split(e);var h=parseInt(c[f.indexOf("y")],10);if(h.toString().length<=2){h+=2000}if(isNaN(h)){return""}var b=parseInt(c[f.indexOf("m")],10)-1;if(isNaN(b)){return""}var g=parseInt(c[f.indexOf("d")],10);if(isNaN(g)){return""}else{g=1}return new Date(h,b,g)};document.writeln('<div id="__calendarPanel" style="position:absolute;left:0px;top:-220px; visibility:hidden;z-index:9999;background-color:#FFFFFF;border:1px solid #EDEDED;width:226px;height:252px;">');var isIE=!!window.ActiveXObject;var isIE6=isIE&&!window.XMLHttpRequest;var scriframe="";if(isIE6){scriframe='src="/html/blank.html"'}document.writeln('<iframe name="__calendarIframe" '+scriframe+' id="__calendarIframe" width="100%" height="100%" scrolling="no" frameborder="0" style="margin:0px;"></iframe>');var __ci=window.frames.__calendarIframe;__ci.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');__ci.document.writeln('<html xmlns="http://www.w3.org/1999/xhtml">');__ci.document.writeln("<head>");__ci.document.writeln('<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />');__ci.document.writeln("<title>Web Calendar(UTF-8) Written By KimSoft</title>");__ci.document.writeln('<style type="text/css">');__ci.document.writeln("<!--");__ci.document.writeln("body {font-size:12px;margin:0px;text-align:center;padding:10px}");__ci.document.writeln("form {margin:0px;}");__ci.document.writeln("select {font-size:12px;background-color:#fff;}");__ci.document.writeln("table {border:0px solid #CCCCCC;background-color:#FFFFFF}");__ci.document.writeln("th {font-size:12px;font-weight:normal;background-color:#FFFFFF;}");__ci.document.writeln("th.theader {font-weight:normal;background-color:#fff;color:#333;width:24px;border-bottom: 1px solid #EDEDED; padding-top:6px;padding-bottom:6px;}");__ci.document.writeln("select.year,select.month {width:70px;margin-right:6px;height:24px;font-weight:600;background:#F8F8F8;border-radius:2px;border:none;color:#333;}");__ci.document.writeln("select.month {width:60px;}");__ci.document.writeln("input,select{outline:none}");__ci.document.writeln("td {font-size:12px;text-align:center;}");__ci.document.writeln("td.normal{background-color:#fff;cursor:default;color:#333;border:1px solid #fff;height:22px;}");__ci.document.writeln("input.l,input.r {border: none;background-color:#fff;width:20px;height:20px;font-size:16px;color:#999;cursor:pointer}");__ci.document.writeln("input.b {border: 1px solid #E0E0E0;width:72px;height:24px;background-color:#fff;width:90%;color:#333;cursor:pointer}");__ci.document.writeln("input.b:hover {background-color:#FAFAFA;}");__ci.document.writeln("tr:last-child th{border-top:1px solid #EDEDED;padding-top:10px;}");__ci.document.writeln("-->");__ci.document.writeln("</style>");__ci.document.writeln("</head>");__ci.document.writeln("<body>");__ci.document.writeln("</body>");__ci.document.writeln("</html>");__ci.document.close();document.writeln("</div>");var calendar=new Calendar();
