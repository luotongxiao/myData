function paixu(a){var b=document.getElementById(a);b.onclick()}function getNewTitle(a,b,c){var d,e,f,g,h,i,j,k,l,m;if(isExporting)return b;if(d=11,e=Math.floor(a/c),f=Math.floor(e/d),f>=10?f-=2:f>=2&&(f-=1),g="",h="<br/>",g="",i="",j=Math.ceil(b.length/f),j>1)for(k=1;j>=k;k++)1==k?(g+=b.substring(0,f)+h,i=b.substring(f)):(l=0,m=f,i.length>f?(g+=i.substring(l,m)+h,i=i.substring(m)):i.length>0&&(g+=i.substring(l)));else g=b;return g}function initChart(){var a,b;if(divDataIds){for(a=divDataIds.split(","),b=0;b<a.length;b++)divarray.push(document.getElementById(a[b]));$.each(divarray,function(){var a,b,c,d;return $(this).find("li").click(function(){var a=$(this).parent().parent(),b=a.next().next(),c=getTable(a.prev());renderChart(c,a,b,this)}),a=$(this),b=$(this).attr("type"),"0"!=b&&"1"!=b?!0:(c=getTable($(this).prev()),d=c.rows[0],d.cells[0].parentTable=d.cells[1].parentTable=c,d.cells[0].onclick=d.cells[1].onclick=function(){var e,f,g,d=this.getElementsByTagName("i")[0];d&&(d.className.toLowerCase().indexOf("icon-up")>-1?d.className="icon icon-down":d.className.toLowerCase().indexOf("icon-down")>-1?(d.className="icon icon-up",d.alt="↑"):(d.className="icon icon-down",d.alt="↓")),0==this.cellIndex?c.sortType=0:(e=c.sortType,e=e?1==e?2:1:1,c.sortType=e),f="0"==b,sortTable(c.tBodies[0],this.cellIndex,!0,f),a[0].lastObj&&(g=a[0].lastObj,a[0].lastObj=null,$(g).trigger("click"))},void 0)})}}function saveChart(a){var e,f,b=$(a).parent().prev(),c=b.highcharts();return b.width(),e="image/png",$.browser=new Object,$.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),$.browser.safari=/safari/.test(navigator.userAgent.toLowerCase()),$.browser.msie=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/),$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase()),$.browser.safari=!$.browser.chrome&&$.browser.safari,$.browser.msie&&($.browser.version=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/)[1]),f=$.browser.msie&&("6.0"==$.browser.version||"7.0"==$.browser.version||"8.0"==$.browser.version||"9.0"==$.browser.version),($.browser.safari||$.browser.opera)&&(f=!0),f?(c.exportChart({type:e,scale:1}),void 0):(c.exportChartLocal({type:e,scale:1}),void 0)}function printChart(a){var b=$(a).parent().prev(),c=b.highcharts();c.print()}function daozhiChart(a){var e,b=$(a).parent().prev(),c=b.prev().prev(),d=b[0].tableData;d?c=b[0].divResultCss:d=getTable(c.prev()),d.daoZhi=!d.daoZhi,c[0].lastObj&&(e=c[0].lastObj,c[0].lastObj=null,$(e).trigger("click"))}function percentChart(a){var e,f,g,h,i,j,k,l,m,n,o,p,b=$(a).parent().prev(),c=b.prev().prev(),d=b[0].tableData;if(d?c=b[0].divResultCss:d=getTable(c.prev()),d.notPercent=!d.notPercent,a.innerHTML="数值"==a.innerHTML?"百分比":"数值",e=c.attr("type"),"3"==e||"4"==e)for(f=d.rows,g=f.length,h=1;g>h;h++)for(i=f[h].cells,j=i.length,"4"==e&&(j-=1),k=1;j>k;k++)l=$(i[k]).text(),i[k].dval||(m=l.split("("),n=m[0],o=m[1].replace(")","").replace("[详细]",""),i[k].dval=n,i[k].dpercent=o),i[k].innerHTML=d.notPercent?i[k].dval:i[k].dpercent;c[0].lastObj&&(p=c[0].lastObj,c[0].lastObj=null,$(p).trigger("click"))}function renderChart(a,b,c,d){var g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,e=$(d).attr("index"),f=window.location.href.indexOf("/mobile/")>-1;if("0"==e){for(a.removeEmpty=a.removeEmpty?!1:!0,g=a.removeEmpty?"显示零数据":"隐藏零数据",f&&(g=g.replace("数据","")),$(d).find("a")[0].innerHTML=g,h=a.rows,r=1;r<h.length-1;r++)i=h[r].cells[1].innerHTML,"0"==i&&(h[r].style.display=a.removeEmpty?"none":"");return b[0].lastObj&&(j=b[0].lastObj,b[0].lastObj=null,$(j).trigger("click")),void 0}if("-1"==e)return!b.hideTable,$(a).toggle(),$(d).toggleClass("liSelect"),void 0;if(b[0].lastObj==d&&c.is(":visible"))return c.hide(),c.next().hide(),$(d).removeClass("liSelect"),b[0].lastObj=null,void 0;if(b[0].lastObj&&$(b[0].lastObj).removeClass("liSelect"),b[0].lastObj=d,$(b[0].lastObj).addClass("liSelect"),l=new Array,m=!a.notPercent,n=a.rows,o=n.length,p=b.attr("type"),"1"==p?m=!1:"1"==n[o-1].getAttribute("total")&&(o=n.length-1),q=!1,"2"==p)if(m=!1,a.daoZhi)for(r=1;o>r;r++)for(s=n[r].cells,t=$(s[0]).text(),r==o-1&&(t="平均值"),u=s.length-1,v=1;u>v;v++)w=$(s[v]).text(),x=$(n[0].cells[v]).text(),y=parseFloat(w),l.push({name:x,group:t,value:y});else for(r=1;o>r;r++)for(s=n[r].cells,x=$(s[0]).text(),r==o-1&&(x="平均值"),u=s.length-1,v=1;u>v;v++)w=$(s[v]).text(),t=$(n[0].cells[v]).text(),y=parseFloat(w),l.push({name:x,group:t,value:y});else if("3"==p||"4"==p){for(300==c.height()&&(c.height(400),o>5&&c.height(600)),z=1,f&&(z=2),r=z;o>r;r++){if(s=n[r].cells,x="",x=f?$(n[r-1].cells[0]).text().replace("[详细]",""):$(s[0]).text().replace("[详细]",""),u=s.length,"4"==p&&(u-=1),"4"==p&&"3"==e)m=!1,w=$(s[u]).text(),y=parseFloat(w),l.push({name:x,group:"group",value:y});else for(v=1;u>v;v++)w=$(s[v]).text(),t=$(n[0].cells[v]).text(),y="",s[v].dval?y=a.notPercent?parseFloat(s[v].dval):parseFloat(s[v].dpercent):(i=w.split("("),y=parseFloat(i[0]),m&&(y=parseFloat(i[1].replace(")","").replace("%","")))),l.push({name:x,group:t,value:y});f&&r++}o>=6&&(q=!0)}else for(r=1;o>r;r++)"none"!=n[r].style.display&&(s=n[r].cells,x=$(s[0]).text().replace("[详细]",""),w=$(s[1]).text(),2==s.length&&(m=!1),A=$(s[2]).attr("percent"),y=parseFloat(w),m&&A&&(y=parseFloat(A)),l.push({name:x,group:"group",value:y}));B=null,"1"==e?B=HighChart.ChartOptionTemplates.Pie(l,m):"6"==e?B=HighChart.ChartOptionTemplates.Pie(l,m,!0):"2"==e?B=HighChart.ChartOptionTemplates.Bars(l,2,m,c[0].noStack):"3"==e?B=HighChart.ChartOptionTemplates.Bars(l,3,m,c[0].noStack):"4"==e?B=HighChart.ChartOptionTemplates.Bars(l,4,m,c[0].noStack):"5"==e&&(B=HighChart.ChartOptionTemplates.Bars(l,5,m,c[0].noStack)),c.show(),C=c.next(),C.show(),HighChart.RenderChart(B,c),q&&(c[0].divTip||(D=document.createElement("div"),D.style.paddingBottom="5px",D.style.textAlign="center",D.parent=c[0],D.innerHTML="<b>提示：</b>由于此题矩阵小题数量大小等于5题，默认会显示堆叠图，<a href='javascript:' class='link-U00a6e6'>点击显示展开图形</a>",C.after(D),c[0].divTip=D,E=D.getElementsByTagName("a")[0],E.onclick=function(){var c,d,e,a=this.parentNode.parent,b=$(a);a.noStack?(a.noStack=0,400==b.height()&&b.height(600),this.innerHTML="点击显示展开图形"):(a.noStack=1,600==b.height()&&b.height(400),this.innerHTML="点击显示堆叠图"),c=b.prev().prev(),d=b[0].tableData,d?c=b[0].divResultCss:d=getTable(c.prev()),c[0].lastObj&&(e=c[0].lastObj,c[0].lastObj=null,$(e).trigger("click"))}),c[0].divTip.style.display="2"==e||"4"==e?"":"none")}function saveKeyword(){qnkeywords&&currentQIndex&&($.post("/handler/saveqword.ashx?activity="+activityId+"&qi="+currentQIndex,{data:qnkeywords},function(){}),currentQIndex="",qnkeywords="")}function Display(a,b){if("displayChart"==a.name)processDiv(b,a);else if("displayTable"==a.name)$.each(divarray,function(){$(this).prev().find("table").toggle()});else if("displayTableTiao"==a.name)$.each(divarray,function(){$(this).prev().find("div.bar").toggle()});else if("displayValue"==a.name){$.each(divarray,function(){var a=$(this).attr("type");"0"==a?$(this).prev().find(".avgval").toggle():"4"==a&&$(this).parent().parent().find(".avgval").toggle()});var c=document.getElementById("lblValueTotal");if(null==c)return;c.style.display=""==c.style.display?"none":""}}function processDiv(a,b){$.each(divarray,function(){var c,d;return $(this).is(":visible")?(c=$(this).find("li[index='"+a+"']")[0],c&&(d=$(c).parent().parent(),getTable($(this).prev()),d[0].lastObj==c&&b.checked&&(d[0].lastObj=null),$(c).trigger("click")),void 0):!0})}function getTable(a){var b=a[0].children[0];return b&&"table"==b.tagName.toLowerCase()||(b=a[0].children[0].children[0]),b&&"table"==b.tagName.toLowerCase()||(b=a[0].children[1].children[0]),(!b||"table"!=b.tagName.toLowerCase()&&a[0].children[2])&&(b=a[0].children[2].children[0]),b}function GenerateReport(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(0==window.isPub&&-1!=window.quesId)return alert("很抱歉，只有问卷发布者才能使用此功能！"),void 0;if(window.NeedSamplePay)return samplePay(),void 0;b=new Array,b.sort(function(a,b){return a.qIndex-b.qIndex}),c=new Array,d=new Array,e=new Array,f=new Array,g=new Array;for(h in matrixArray)d.push(h);i="",j="",k="t",window.cbFilter?(l=cbFilter.getElementsByTagName("input"),l&&(i=l[0].checked?"t":"",j=l[1].checked?"t":""),k=document.getElementById("displayTableTiao").checked?"t":"f"):j="t",m="",n=0,o=!1,isExporting=!0,p=window.maxImageCount||100,$.each(divarray,function(){var i,j,k,l,a=$(this),b=$(this).next().next(),d=getTable($(this).prev()),h=$(d).attr("qi");return d.sortType&&e.push(h+";"+d.sortType),$(this).is(":visible")&&($(d).is(":visible")||c.push(h)),d.removeEmpty&&g.push(h),(1==d.notPercent||0==d.notPercent)&&(i=a.attr("type"),j="0",d.notPercent&&(j=1),("3"==i||"4"==i)&&f.push(h+","+j)),a[0].lastObj&&(k=$(b).highcharts(),l=k.getSVGForExport(),m&&(m+="¤"),m+=h+"〒"+l,n++,n==p)?!1:void 0}),isExporting=!1,hfSvg.value=m,n>=p&&alert("提示：一次最多只能下载"+p+"个图片！"),q="/wjx/activitystat/viewstatsavenew.aspx?activity="+activityId+"&fe="+i+"&fj="+j+"&dtt="+k,window.reportId?q+="&reportId="+reportId:window.sourceid?q+="&sourceid="+sourceid:window.quesId&&(q+="&quesid="+window.quesId,window.userId&&window.userId>0&&(q+="&uid="+window.userId)),window.systemCond&&(q+=systemCond),o&&(q+="&bs64=1"),q+="&t="+c.join(",")+"&m="+d.join(","),e.length>0&&(q+="&st="+e.join(",")),f.length>0&&(q+="&pa="+f.join(";")),g.length>0&&(q+="&re="+g.join(",")),qCond?(cond=3==reportType?"&arc=":"&qc=",cond+=encodeURIComponent(qCond)):cond="&qc=",eCond&&(cond+=3==reportType?"&aec=":"&ec=",cond+=encodeURIComponent(eCond)),reportName&&(r=reportName.replace(/\(/g,"（").replace(/\)/g,"）"),cond+="&name="+encodeURIComponent(r)),q+=cond+"&reporttype="+reportType,window.location.href.indexOf("/mobile/statnew.aspx")>-1?(q=q.replace("/wjx/activitystat/viewstatsavenew.aspx","/mobile/statdown.aspx"),location.href=q):PDF_launch(q,600,320)}function ShowMatrix(a,b){var e,f,g,c="divDetail"+a,d=document.getElementById(c);d.style.display="none"==d.style.display?"":"none",b.innerHTML="none"==d.style.display?"查看详细数据":"查看总体数据",e="divTotal"+a,f=document.getElementById(e),f.style.display="none"==f.style.display?"":"none",g=1e4*parseInt(a),matrixArray[g]?delete matrixArray[g]:matrixArray[g]=c}function queryMutipleChoiceAccuracy(a,b){var e,f,c=$(a).attr("topic"),d="1"==$(a).attr("isq");hashPercent[c]||(e="MultipleChoiceAccuracy.ashx",d&&(e="QuestionAccuracy.ashx"),f="/handler/"+e+"?activity="+activityId+"&questionIndex="+c,window.qCond&&(f+="&arc="+encodeURIComponent(qCond)),window.eCond&&(f+="&ec="+encodeURIComponent(eCond)),b&&(f+="&all="+b),$.ajax({url:f,async:!1,success:function(d){if(b){if("time"==d)return spanAll.innerHTML="&nbsp;&nbsp;提示：10分钟内只能执行一次&nbsp;&nbsp;",canAll=!1,void 0;spanAll.innerHTML="&nbsp;&nbsp;执行"+iStep+"/"+allbtnArray.length+"&nbsp;&nbsp;"}a.style.display="none",hashPercent[c]=d,showAccuracy(d,c)}}))}function getRandom(){return Math.ceil(10*Math.random())+""}function showAll(a){var b,d;return window.wjxStatus&&window.NeedLazyLoad?(alert("提示：只有暂停状态下的问卷可以使用此功能！"),void 0):(canAll=!0,allguid=getRandom()+getRandom()+getRandom(),b=$(".correctbutton"),b.length,a&&(spanAll=a.parentNode,spanAll.innerHTML="&nbsp;执行中..."),d=new Sleeper,b.each(function(){allbtnArray.push(this),d.push(function(){canAll&&queryMutipleChoiceAccuracy(allbtnArray[iStep++],allguid)})}),d.run(),void 0)}function Sleeper(){var a=this;return a.step=0,a.actions=[],a.push=function(b){return a.actions.push(b),a},a.run_next=function(){if(a.step<a.actions.length){var b=a.actions[a.step];b(),++a.step,setTimeout(a.run_next,1500)}},a.run=function(){a.run_next()},a}function showAccuracy(a,b){var f,g,c=a.split(","),d=0,e=$("#percent_"+b);c[0]&&c[1]&&c[1]>0&&(d=(100*(c[0]/parseFloat(c[1]))).toFixed(2),f=e.parent().parent(),$(".ckpercent",f).each(function(){var a=this.parentNode.parentNode,b=a.cells[1],d=(100*(parseFloat(b.innerHTML)/parseFloat(c[1]))).toFixed(2);this.innerHTML=d+"%",$(".precent",a).width(d+"%")})),e.html('<b>正确率:</b><i style="color:#ff6161;">'+d+"%</i>").css("display",""),hasShowAll||(g=document.createElement("span"),g.style.fontWeight="normal",g.innerHTML="&nbsp;&nbsp;<a href='javascript:' onclick='showAll(this);' class='wjx_alink_gray' style='background: #fff;border: none;width: auto;'>显示全部题目正确率</a>&nbsp;&nbsp;",e.append(g),hasShowAll=!0)}function queryChoicePercent(a,b){var d,e,c=$(a).attr("topic");c&&(hashPerLazy[c]||(d="",$(a).parent().parent().prev().text().indexOf("[多选题]")>-1&&(d="&ick=1"),e="/handler/GetChoiceData.ashx?activity="+activityId+"&questionIndex="+c+d,window.qCond&&(e+="&arc="+encodeURIComponent(qCond)),window.eCond&&(e+="&ec="+encodeURIComponent(eCond)),b&&(e+="&all="+b),$.ajax({url:e,async:!1,success:function(d){if(b){if("time"==d)return spanAll.innerHTML="&nbsp;&nbsp;提示：10分钟内只能执行一次&nbsp;&nbsp;",canAllPercent=!1,void 0;spanAll.innerHTML="&nbsp;&nbsp;执行"+iStep+"/"+allbtnArray.length+"&nbsp;&nbsp;"}a.style.display="none",hashPerLazy[c]=d,showLazyPercent(d,c)}})))}function showLazyPercent(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,c=!1,d=!0;for(window.cbFilter&&(e=cbFilter.getElementsByTagName("input"),e&&(c=e[0].checked,d=e[1].checked)),f=$("#ipt_"+b),g=!1,f.parent().parent().prev().text().indexOf("[多选题]")>-1&&(g=!0),h=0,i=a.split("|"),h=parseInt(i[0]),g||(h=0),j=i[1].split(";"),k=new Object,l=0,m=0,n=0;n<j.length;n++)o=j[n].split(","),p=parseInt(o[0]),q=parseInt(o[1]),!g&&p>0?h+=q:-2==p?l=q:-3==p&&(m=q),k[o[0]]=o[1];g?(c&&(h-=l),d&&(h-=m)):(c||(h+=l),d||(h+=m)),h&&(s=f.parent().parent(),t=0,$("tr",s).each(function(){var a,b,c,d,e,f,i;return"1"==this.getAttribute("total")?(this.cells[1].innerHTML=h,!0):(a=this.cells[0],b=a.getAttribute("val"),b&&k[b]?(c=parseInt(k[b]),d=(100*(parseFloat(c)/parseFloat(h))).toFixed(2),e=$(a).text(),g||t||(f=e.indexOf("(答案)"),f>-1&&f==e.length-4&&(t=d)),this.cells[1].innerHTML=c,i=d+"%",$(".precent",this.cells[2]).width(i).parent().next().html(i),$(this.cells[2]).attr("percent",d),void 0):!0)}),f.parent().next().show(),s.next().show(),t&&f.parent().next().find("i").html(t+"%")),hasShowAllPercent||(u=document.createElement("span"),u.style.fontWeight="normal",u.innerHTML="&nbsp;&nbsp;<a href='javascript:' onclick='showAllPercent(this);' class='link-U666'>显示全部题目数据</a>&nbsp;&nbsp;",f.parent().append(u),hasShowAllPercent=!0)}function showAllPercent(a){var b,d;return window.wjxStatus?(alert("提示：只有暂停状态下的问卷可以使用此功能！"),void 0):(canAllPercent=!0,allguid=getRandom()+getRandom()+getRandom(),b=$(".percentbutton[topic]"),b.length,spanAll=a.parentNode,spanAll.innerHTML="执行中...&nbsp;&nbsp;",d=new Sleeper,b.each(function(){allbtnArray.push(this),d.push(function(){canAllPercent&&queryChoicePercent(allbtnArray[iStep++],allguid)})}),d.run(),void 0)}function sortTable(a,b,c,d){var g,h,i,j,k,l,m,n,e="object"==typeof a?a:document.getElementById(a);for(null==e.reverseSort&&(e.reverseSort=new Array,e.lastColumn=2),e.reverseSort[b]=null==e.reverseSort[b]?c:!e.reverseSort[b],e.lastColumn=b,e.style.display,n=e.rows.length,d&&(n-=1),h=1;n-1>h;h++){for(k=h,j=getTextValue(e.rows[h].cells[b]),i=h+1;n>i;i++)l=getTextValue(e.rows[i].cells[b]),m=compareValues(j,l),e.reverseSort[b]&&(m=-m),m>0&&(k=i,j=l);k>h&&(g=e.removeChild(e.rows[k]),e.insertBefore(g,e.rows[h]))}return!1}function getTextValue(a){var c,d,b=a.getAttribute("val");if(b)return b;for(d="",c=0;c<a.childNodes.length;c++)d+=a.childNodes[c].nodeType==document.TEXT_NODE?a.childNodes[c].nodeValue:a.childNodes[c].nodeType==document.ELEMENT_NODE&&"BR"==a.childNodes[c].tagName?" ":getTextValue(a.childNodes[c]);return normalizeString(d)}function compareValues(a,b){var c,d;return c=parseFloat(a),d=parseFloat(b),isNaN(c)||isNaN(d)||(a=c,b=d),a==b?0:a>b?1:-1}function normalizeString(a){return a=a.replace(whtSpMult," "),a=a.replace(whtSpEnds,"")}function makePretty(a,b){var c,d,e,f,g;for(c=0;c<a.rows.length;c++)for(e=a.rows[c],e.className=e.className.replace(rowTest,""),0!=c%2&&(e.className+=" "+rowClsNm),e.className=normalizeString(e.className),d=2;d<a.rows[c].cells.length;d++)f=e.cells[d],f.className=f.className.replace(colTest,""),d==b&&(f.className+=" "+colClsNm),f.className=normalizeString(f.className);for(g=a.parentNode.tHead,e=g.rows[g.rows.length-1],c=2;c<e.cells.length;c++)f=e.cells[c],f.className=f.className.replace(colTest,""),c==b&&(f.className+=" "+colClsNm),f.className=normalizeString(f.className)}function setRanks(a,b,c){var f,g,h,i,j,k,l,d=0,e=1;for(a.reverseSort[b]&&(c=!c),c&&(e=-1,d=a.rows.length-1),f=1,g=f,i=null;b>1&&d>=0&&d<a.rows.length;)h=getTextValue(a.rows[d].cells[b]),null!=i&&0!=compareValues(h,i)&&(g=f),a.rows[d].rank=g,i=h,f++,d+=e;for(l=0,d=0;d<a.rows.length;d++){for(j=a.rows[d],k=j.cells[0];null!=k.lastChild;)k.removeChild(k.lastChild);b>1&&j.rank!=l&&(k.appendChild(document.createTextNode(j.rank)),l=j.rank)}}function GetResult(a,b){var c="/wjx/activitystat/generatecsvresult.ashx?ojbk="+encodeURIComponent(a)+"&sign="+encodeURIComponent(b)+"&t="+(new Date).getTime();$.get(c,function(a){"1"==a&&(clearInterval(timerBigData),window.location.href=window.location.href.replace(/#(\d+)?/gi,""))})}function applyGetAllData(a){if(!isSubmiting){isSubmiting=!0;var b="/handler/statistics/BigDataActivityApply.ashx?ajaxtype=1&activityId="+activityId;window.qCond&&(b+="&arc="+encodeURIComponent(qCond)),window.eCond&&(b+="&ec="+encodeURIComponent(eCond)),window.sourceid&&(b+="&sourceid="+sourceid),window.quesId&&(b+="&quesid="+quesId),window.userId&&(b+="&userid="+userId),$.ajax({url:b,type:"get",cache:!1,success:function(b){if(b){var c="";b.data.objk?(c="<b>提示：</b>您提交的获取数据申请正在后台执行，约5-10分钟内会自动刷新数据，同时也会通过系统消息提醒您。",timerBigData=setInterval(function(){GetResult(b.data.objk,b.data.sign)},querytime)):c=b.data,$(a).parent().html(c)}isSubmiting=!1},error:function(){isSubmiting=!1}})}}function selEnlargeWay(a){var b=$(a).parent(".ctrolBtnGroup").prev(".fillet__chart--dataGraph"),c=$("<div class='selEnlargeStyleBox'><ul><li class='cur'>只缩放高度<li>等比例缩放</li><li>原始大小</li></ul></div>"),d=b.parent().width();timerEnlargeWay&&clearTimeout(timerEnlargeWay),0==$("body .selEnlargeStyleBox").length&&($("body").append(c),$(".selEnlargeStyleBox").css({"z-index":"300",display:"none",position:"absolute",top:"100px",left:0,width:"100px",padding:"6px 0","background-color":"#FFF","border-radius":"3px",border:"1px solid #D9D9D9","box-shadow":"0px 2px 10px 0px rgba(0,0,0,0.1)"}),$(".selEnlargeStyleBox li").css({cursor:"pointer","font-size":"13px","line-height":"33px",color:"#262626","text-align":"left",padding:"0 16px"}),$(".selEnlargeStyleBox .cur").css({"background-color":"#F7F7F7"}),$(".selEnlargeStyleBox").on("click","li",function(a){if(a.stopPropagation(),$(".selEnlargeStyleBox").hide(),timerEnlargeWay&&clearTimeout(timerEnlargeWay),2==$(this).index()){b.width(d),b.height(300),b.css("margin-left","auto");var c=b.highcharts();return c.reflow(),void 0}enlargeWay=$(this).index(),$(this).css("background-color","#F7F7F7").siblings("li").css("background-color","#fff")}),$(document).on("click",function(){$(".selEnlargeStyleBox").hide()})),timerEnlargeWay=setTimeout(function(){var b=$(a).offset().left,c=$(a).offset().top;c-$(window).scrollTop()+100>$(window).height()?$(".selEnlargeStyleBox").show().css({left:b,top:"auto",bottom:$(window).height()-c+10}):$(".selEnlargeStyleBox").show().css({left:b,top:c+34,bottom:"auto"}),clearTimeout(timerEnlargeWay)},600)}function enlargeChart(a,b){var e,f,c=$(a).parent().prev(),d=c.parent().width();if(timerEnlargeWay&&clearTimeout(timerEnlargeWay),b){if(1.1*c.width()>.8*document.documentElement.clientWidth)return;1==enlargeWay?c.width(1.1*c.width()):c.width(d),c.height(1.1*c.height())}else 1==enlargeWay?c.width(c.width()/1.1):c.width(d),c.height(c.height()/1.1);e=c.width(),e>d&&1==enlargeWay?c.css("margin-left",-parseInt((e-d)/2)+"px"):(c.css("margin-left","auto"),c.css("margin-right","auto")),f=c.highcharts(),f.reflow()}var HighChart,divarray,qnkeywords,currentQIndex,isExporting,matrixArray,hashPercent,hasShowAll,canAll,spanAll,allguid,allbtnArray,iStep,hashPerLazy,canAllPercent,hasShowAllPercent,cbtns,whtSpEnds,whtSpMult,rowClsNm,colClsNm,rowTest,colTest,timerBigData,isSubmiting,enlargeWay,timerEnlargeWay;Array.prototype.contains=function(a){for(var b=this.length;b--;)if(this[b]===a)return!0;return!1},HighChart={ChartDataFormate:{FormateNOGroupData:function(a){var d,b=[],c=[];for(d=0;d<a.length;d++)b.push(a[d].name||""),c.push([a[d].name,a[d].value||0]);return{category:b,data:c}},FormatGroupData:function(a){var e,f,g,h,i,b=new Array,c=new Array,d=new Array;for(e=0;e<a.length;e++)b.contains(a[e].name)||b.push(a[e].name),c.contains(a[e].group)||c.push(a[e].group);for(e=0;e<c.length;e++){for(f={},g=new Array,h=0;h<a.length;h++)for(i=0;i<b.length;i++)c[e]==a[h].group&&a[h].name==b[i]&&g.push(a[h].value);f={name:c[e],data:g,dataLabels:{enabled:!0}},d.push(f)}return{category:b,series:d}}},ChartOptionTemplates:{Pie:function(a,b,c){var f,g,h,d=HighChart.ChartDataFormate.FormateNOGroupData(a),e=!1;for(f=0;f<d.category.length;f++)d.category[f].length>10&&(e=!0);return g="",c&&(g="50%"),h={chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,style:{fontFamily:"Microsoft YaHei"}},credits:{enabled:!1},exporting:{enabled:!1},colors:window.chartColor||["#0095FF","#36CFC9","#FFC53D","#FF7A45","#73D13D","#455A64","#69C0FF","#BAE637","#B37FEB","#FFEC3D","#FF7875","#262626","#597EF7","#26A69A","#FF9800","#EC407A","#D4E157","#795548","#F759AB","#827717"],title:{text:""},tooltip:{formatter:function(){var a=this.y;return b&&(a=this.y+"%"),"<b>"+this.point.name+"</b>："+a},useHTML:!0,percentageDecimals:1,style:{fontFamily:"Microsoft YaHei"}},legend:{itemStyle:{fontWeight:"normal",fontFamily:"Microsoft YaHei"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var c,a=this.y;return b&&(a=this.y+"%"),e?a:(c=this.point.name,c.length>10&&(c=c.substr(0,10)+"... "),c+": "+a)}},showInLegend:e}},series:[{type:"pie",name:"",data:d.data,innerSize:g}]}},Bars:function(a,b,c,d){var g,h,i,j,k,l,m,n,o,e="column",f=!1;return 3==b?e="line":4==b?e="bar":5==b&&(f=!0,e="line"),g=["#33a3dc","#76c0ec","#95dc7c","#cce863","#ff9c9c","#fca000","#22b5c3","#a3be57","#fff500","#48cfef","#25bf6e","#ea5f35","#7e85e0","#f2bd7c","#bbbbba","#7257a2"],h=HighChart.ChartDataFormate.FormatGroupData(a,c),i=h.series.length>1,j="",k=!0,5!=b&&"bar"!=e&&h.category.length*h.series.length>20&&(k=!1),l=!1,1==d?l=!1:i&&h.category.length>4&&(l=!0),i&&l&&(j=c?"percent":"normal"),j&&(m=h.series.length,2==m&&(g=["#fca000","#33a3dc"])),n={chart:{polar:f,type:e,style:{fontFamily:"Microsoft YaHei"}},legend:{enabled:i,itemStyle:{fontWeight:"normal",fontFamily:"Microsoft YaHei"},labelFormatter:function(){return this.name.length>12?this.name.substr(0,12)+"...":this.name}},title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},colors:window.chartColor||g,xAxis:{categories:h.category,labels:{formatter:function(){return j?getNewTitle(this.axis.width,this.value,h.category.length):this.value},style:{fontWeight:400,color:"#333",fontSize:"12px"},useHTML:j?!0:!1}},yAxis:{lineWidth:1,gridLineWidth:0,title:{text:""},labels:{style:{fontWeight:400,color:"#333",fontSize:"12px"}}},tooltip:{formatter:function(){var a=this.y;return c&&(a=this.y+"%"),i?"<b>"+this.series.name+"</b>："+a:"<b>"+this.x+"</b>："+a},useHTML:!0,percentageDecimals:1,style:{fontFamily:"Microsoft YaHei"}},plotOptions:{column:{pointPadding:.2,borderWidth:0,stacking:j,dataLabels:{enabled:!0,allowOverlap:k,style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var a=this.y;return 0==a&&j?"":(c&&(a=this.y+"%"),a)}}},bar:{pointPadding:.2,borderWidth:0,stacking:j,dataLabels:{enabled:!0,allowOverlap:!0,style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var a=this.y;return 0==a&&j?"":(c&&(a=this.y+"%"),a)}}},line:{dataLabels:{enabled:!0,allowOverlap:k,style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var a=this.y;return c&&(a=Highcharts.numberFormat(this.y,0)+"%"),a}}},series:{minPointLength:6}},series:h.series},5==b?(o={pane:{size:"80%"},xAxis:{categories:h.category,tickmarkPlacement:"on",lineWidth:0,labels:{style:{fontWeight:400,color:"#333",fontSize:"12px"}}},yAxis:{labels:{enabled:!1,style:{fontWeight:400,color:"#333",fontSize:"12px"}},gridLineInterpolation:"polygon",lineWidth:0,min:0}},$.extend({},n,o)):n}},RenderChart:function(a,b){b.highcharts(a)}},divarray=new Array,$(window).load(function(){initChart()}),qnkeywords="",currentQIndex="",isExporting=!1,matrixArray=new Object,hashPercent=new Object,hasShowAll=!1,canAll=!1,spanAll=null,allguid="",allbtnArray=new Array,iStep=0,hashPerLazy=new Object,canAllPercent=!1,hasShowAllPercent=!1,window.NeedLazyLoad&&(cbtns=$(".percentbutton"),cbtns.each(function(){return"获取数据"!=this.value?!0:($(this).parent().next().hide(),$(this).parent().parent().next().hide(),void 0)})),null==document.ELEMENT_NODE&&(document.ELEMENT_NODE=1,document.TEXT_NODE=3),whtSpEnds=new RegExp("^\\s*|\\s*$","g"),whtSpMult=new RegExp("\\s\\s+","g"),rowClsNm="alternateRow",colClsNm="sortedColumn",rowTest=new RegExp(rowClsNm,"gi"),colTest=new RegExp(colClsNm,"gi"),timerBigData=null,isSubmiting=!1,$(function(){window.objk&&window.sign&&objk.length>0&&sign.length>0&&(timerBigData=setInterval(function(){GetResult(objk,sign)},querytime))}),enlargeWay=0;